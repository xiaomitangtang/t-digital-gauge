module.exports=function(t){var i={};function e(o){if(i[o])return i[o].exports;var s=i[o]={i:o,l:!1,exports:{}};return t[o].call(s.exports,s,s.exports,e),s.l=!0,s.exports}return e.m=t,e.c=i,e.d=function(t,i,o){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var s in t)e.d(o,s,function(i){return t[i]}.bind(null,s));return o},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=0)}([function(t,i,e){"use strict";function o(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}e.r(i);const s=Math.PI;i.default=class{constructor(t,i){o(this,"dom",null),o(this,"canvas",null),o(this,"ctx",null),o(this,"timer",null),o(this,"timerTime",20),o(this,"resizeTimer",null),o(this,"currentValue",0),o(this,"realValue",0),o(this,"size",{w:0,h:0}),o(this,"defaultOption",{type:"vertical",value:90,min:0,max:100,tickWidthPercent:.3,minTickWidth:20,maxTickWidth:60,lineCap:"butt",backgroundColor:"#eee",foreColor:"#00ff00",tickMinColor:"rgba(0,255,0,1)",tickMaxColor:"rgba(255,0,0,1)",colorType:"stepMultiple",showValue:!0,showMinLabel:!0,showMaxLabel:!0,minLabelColor:"#ddd",maxLabelColor:"#ddd",stepColors:[[.95,"#ff031b"],[.9,"#ff4828"],[.8,"#ff710a"],[.7,"#ffad02"],[.6,"#ffdb00"],[.5,"#f1f502"],[.4,"#b1eb05"],[.3,"#81eb0a"],[.2,"#38d912"],[.1,"#04cc17"],[0,"#02b013"]],animation:!0,animationDuration:500}),o(this,"gaugeOptionForType",{vertical:{minLabelOffset:[8,5],maxLabelOffset:[8,5],padding:[15,5],valueOffset:[0,-5],valueTextAlign:"center",minLabelTextAlign:"left",maxLabelTextAlign:"left",valueTextBaseline:"bottom",minLabelTextBaseline:"bottom",maxLabelTextBaseline:"top",tickRatio:10,BlankTickRatio:1},horizontal:{padding:[5,25],minLabelOffset:[0,5],maxLabelOffset:[0,5],valueOffset:[0,0],valueTextAlign:"center",minLabelTextAlign:"left",maxLabelTextAlign:"right",valueTextBaseline:"bottom",minLabelTextBaseline:"top",maxLabelTextBaseline:"top",tickRatio:10,BlankTickRatio:1},circle:{padding:[25],minLabelOffset:[0,5],maxLabelOffset:[0,5],valueOffset:[0,0],valueTextAlign:"center",minLabelTextAlign:"left",maxLabelTextAlign:"right",valueTextBaseline:"middle",minLabelTextBaseline:"top",maxLabelTextBaseline:"top",unit:"",subText:"",subTextOffset:[0,0],subTextColor:"",subTextAlign:"center",subTextBaseline:"top",tickRatio:10,BlankTickRatio:1,startArg:0,endArg:2*s},"semi-circle":{padding:[25,25],minLabelOffset:[0,5],maxLabelOffset:[0,5],valueOffset:[0,0],valueTextAlign:"center",minLabelTextAlign:"center",maxLabelTextAlign:"center",valueTextBaseline:"middle",minLabelTextBaseline:"top",maxLabelTextBaseline:"top",tickRatio:10,centerPosition:"bottom",BlankTickRatio:1,autoArg:!0,startArg:s,endArg:2*s}}),this.dom=t,this.draw=this.draw.bind(this),this.setOption(i,!0)}initGauge(){this.dom?(this.dom.innerHTML="",this.canvas=document.createElement("canvas"),this.setSize(),this.ctx=this.canvas.getContext("2d"),this.dom.appendChild(this.canvas),this.setValue(this.option.value)):console.log("没有设置dom元素")}setOption(t,i=!1){let e="",o={};e=t&&t.type?t.type:this.defaultOption.type,o=this.gaugeOptionForType[e],this.option={...this.defaultOption,...o,...t},i?this.initGauge():this.update()}setSize(t){let i,e;t?(i=t.w,e=t.h):(e=this.dom.offsetHeight,i=this.dom.offsetWidth),this.size={w:i,h:e},this.canvas.width=i,this.canvas.height=e}resize(t=null){clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(()=>{this.setSize(t),this.update()},50)}update(){this.setValue(+this.option.value)}draw(t){switch(this.option.type){case"vertical":this.drawVertiva(t);break;case"horizontal":this.drawHorizontal(t);break;case"circle":this.drawCircle(t);break;case"semi-circle":this.drawSemiCircle(t)}}setValue(t,i=!1){if(this.realValue=t,this.option.value=t.toFixed(2),t=this.correctVal(t),clearInterval(this.timer),this.option.animation&&!i){let i=this.currentValue,e=this.option.animationDuration/this.timerTime,o=(t-this.currentValue)/e,s=t>this.currentValue;this.currentValue=t,this.timer=setInterval(()=>{s?i>t&&(clearInterval(this.timer),i=t):i<t&&(clearInterval(this.timer),i=t),this.draw(i),i+=o},this.timerTime)}else this.currentValue=t,this.draw(t)}correctVal(t){let{min:i,max:e}=this.option;return t<i?0:t>e?100:100*(t-i)/(e-i)}calcColor(t){switch(this.option.colorType){case"fixed":return this.option.foreColor;case"stepSingle":return this.getStecpColor(this.currentValue/100);case"stepMultiple":return this.getStecpColor(t);case"gradual":return this.translateColor(t)}}getStecpColor(t){for(let i=0;i<this.option.stepColors.length;i++)if(t>=this.option.stepColors[i][0])return this.option.stepColors[i][1];return this.option.stepColors[0][1]}translateColor(t){let{tickMaxColor:i,tickMinColor:e}=this.option,[o,s,n,a]=this.getRGBA(e),[h,l,r,p]=this.getRGBA(i);return`rgba(${this.valToColormeta(t,h,o)},${this.valToColormeta(t,l,s)},${this.valToColormeta(t,r,n)},${this.valToColormeta(t,p,a,!0)})`}valToColormeta(t,i,e,o=!1){return i=+i,e=+e,o?e+(i-e)*t:Math.round(e+(i-e)*t)}getRGBA(t){if(t.startsWith("rgb")){let i=/rgb[a]?\((\d{1,3}),(\d{1,3}),(\d{1,3})[,]?(\d{1,3})?\)/,[,e,o,s,n]=t.match(i);return[e,o,s,n||1]}if(t.startsWith("#")){let i=(t.length-1)/3,e=`/#(\\S{${i}})(\\S{${i}})(\\S{${i}})/`,[,o,s,n]=t.match(e);return[parseInt(o,16),parseInt(s,16),parseInt(n,16),1]}}getFZ(t,i=!1){return i?t/3:t/3+"px Arial"}drawText(t,i,e,o,n,a,h,l=0,r=null){this.ctx.save(),this.ctx.font=o,this.ctx.fillStyle=n,this.ctx.textAlign=a,this.ctx.textBaseline=h,0!==l&&(this.ctx.translate(i,e),this.ctx.rotate(l/180*s),i=0,e=0),r?this.ctx.fillText(t,i,e,r):this.ctx.fillText(t,i,e),this.ctx.restore()}drawVertiva(t){this.ctx.clearRect(0,0,this.size.w,this.size.h);let i=this.size.w/2,e=this.size.h-this.option.padding[0],o=this.option.padding[0],s=this.option.tickWidthPercent*this.size.w;s<this.option.minTickWidth&&(s=this.option.minTickWidth),s>this.option.maxTickWidth&&(s=this.option.maxTickWidth);let n=s/this.option.tickRatio,a=n*this.option.BlankTickRatio;for(this.ctx.beginPath();e>o;)this.ctx.moveTo(i-s/2,e),this.ctx.lineTo(i+s/2,e),e=e-n-a;this.ctx.lineWidth=n,this.ctx.lineCap=this.option.lineCap,this.ctx.strokeStyle=this.option.backgroundColor,this.ctx.stroke(),e=this.size.h-this.option.padding[0];let h=this.size.h-this.option.padding[0],l=e-o;for(o=e-(e-o)*t/100;e>o;)this.ctx.beginPath(),this.ctx.moveTo(i-s/2,e),this.ctx.lineTo(i+s/2,e),this.ctx.lineWidth=n,this.ctx.strokeStyle=this.calcColor((h-e)/l),e=e-n-a,e<0&&(e=0),this.ctx.stroke();if(this.option.showValue){let e=this.option.value,n=this.getFZ(s),a=this.option.valueTextAlign,h=this.option.valueTextBaseline,l=this.calcColor(t/100),[r,p]=this.option.valueOffset;r=i+r,p=o+p;let c=s-4;this.drawText(e,r,p,n,l,a,h,0,c)}if(this.option.showMinLabel){let t=this.option.min,o=this.getFZ(s);e=this.size.h-this.option.padding[0];let[n,a]=this.option.minLabelOffset,h=this.option.minLabelTextAlign,l=this.option.minLabelTextBaseline,r=this.option.minLabelColor;n=i+s/2+n,a=e+a,this.drawText(t,n,a,o,r,h,l,0)}if(this.option.showMaxLabel){let t=this.option.max,e=this.getFZ(s);o=this.option.padding[0];let n=this.option.maxLabelTextAlign,a=this.option.maxLabelTextBaseline,[h,l]=this.option.maxLabelOffset,r=this.option.maxLabelColor;h=i+s/2+h,l=o+l,this.drawText(t,h,l,e,r,n,a,0)}}drawHorizontal(t){this.ctx.clearRect(0,0,this.size.w,this.size.h);let i=this.size.h/2,e=this.size.w-this.option.padding[1],o=this.option.padding[1],s=this.option.tickWidthPercent*this.size.h;s<this.option.minTickWidth&&(s=this.option.minTickWidth),s>this.option.maxTickWidth&&(s=this.option.maxTickWidth);let n=s/this.option.tickRatio,a=n*this.option.BlankTickRatio;for(this.ctx.beginPath();e>o;)this.ctx.moveTo(o,i-s/2),this.ctx.lineTo(o,i+s/2),o=o+n+a;this.ctx.lineWidth=n,this.ctx.lineCap=this.option.lineCap,this.ctx.strokeStyle=this.option.backgroundColor,this.ctx.stroke(),o=this.option.padding[1];let h=this.option.padding[1],l=e-o;for(e=o+(e-o)*t/100;e>o;)this.ctx.beginPath(),this.ctx.moveTo(o,i-s/2),this.ctx.lineTo(o,i+s/2),this.ctx.lineWidth=n,this.ctx.strokeStyle=this.calcColor((o-h)/l),o=o+n+a,o>e&&(o=e),this.ctx.stroke();if(this.option.showValue){let e=this.option.value,n=this.getFZ(s),a=this.option.valueTextAlign,h=this.option.valueTextBaseline,l=this.calcColor(t/100),[r,p]=this.option.valueOffset;r=o+r,p=i+p;let c=s-4;this.drawText(e,r,p,n,l,a,h,90,c)}if(this.option.showMinLabel){let t=this.option.min,e=this.getFZ(s);o=this.option.padding[1];let[n,a]=this.option.minLabelOffset,h=this.option.minLabelTextAlign,l=this.option.minLabelTextBaseline,r=this.option.minLabelColor;n=o+n,a=i+s/2+a,this.drawText(t,n,a,e,r,h,l,0)}if(this.option.showMaxLabel){let t=this.option.max,o=this.getFZ(s);e=this.size.w-this.option.padding[1];let n=this.option.maxLabelTextAlign,a=this.option.maxLabelTextBaseline,h=this.option.maxLabelColor,[l,r]=this.option.maxLabelOffset;l=e+l,r=i+s/2+r,this.drawText(t,l,r,o,h,n,a,0)}}calcArgPoint(t,i,e,o,s){return[[Math.cos(e)*o+t,Math.sin(e)*o+i],[Math.cos(e)*s+t,Math.sin(e)*s+i]]}correctArgAndGutterArg(t,i,e){let o=e/Math.ceil(e/(t+i));return[t=o*t/(t+i),o-t]}drawCircle(t){this.ctx.clearRect(0,0,this.size.w,this.size.h);let i=this.size.w/2,e=this.size.h/2,o=Math.min(this.size.w/2-this.option.padding[0],this.size.h/2-this.option.padding[0]),s=o*this.option.tickWidthPercent;s<this.option.minTickWidth&&(s=this.option.minTickWidth),s>this.option.maxTickWidth&&(s=this.option.maxTickWidth);let n=o-s;n=n>0?n:.1;let a=s/this.option.tickRatio,h=a/n,l=h*this.option.BlankTickRatio,{startArg:r,endArg:p}=this.option,c=p-r;for([h,l]=this.correctArgAndGutterArg(h,l,c),this.ctx.beginPath();r<p;){let[t,s]=this.calcArgPoint(i,e,r,n,o);this.ctx.moveTo(...t),this.ctx.lineTo(...s),r=r+h+l,r>p&&(r=p)}this.ctx.lineWidth=a,this.ctx.lineCap=this.option.lineCap,this.ctx.strokeStyle=this.option.backgroundColor,this.ctx.stroke();let x=this.option.startArg;for(r=this.option.startArg,p=c*t/100+r;p>r;){let[t,s]=this.calcArgPoint(i,e,r,n,o);this.ctx.beginPath(),this.ctx.moveTo(...t),this.ctx.lineTo(...s),this.ctx.lineWidth=a,this.ctx.lineCap=this.option.lineCap,this.ctx.strokeStyle=this.calcColor((r-x)/c),this.ctx.stroke(),r=r+h+l,r>p&&(r=p)}let d=this.getFZ(n),u=this.calcColor(t/100),m=n-4;if(this.option.showValue){let{value:t,unit:o,valueTextAlign:s,valueTextBaseline:n,valueOffset:a}=this.option,h=t+o,[l,r]=a;l=i+l,r=e+r,this.drawText(h,l,r,d,u,s,n,0,m)}if(this.option.subText){let{subText:t,subTextColor:o,subTextOffset:s,subTextAlign:a,subTextBaseline:h}=this.option,l=this.getFZ(n/2.5),r=this.getFZ(n/2,!0),[p,c]=s;p=i+p,c=e+c+r;let x=o||u;this.drawText(t,p,c,l,x,a,h,0,m)}}drawSemiCircle(t){if(this.ctx.clearRect(0,0,this.size.w,this.size.h),this.option.paddingPercent){let[t,i]=this.option.paddingPercent;this.option.padding=[this.size.w*t,this.size.h*i]}let i,e,o,n=0,a=0,h=0,l=0,r=0,p=0,c=this.option.autoArg;switch(this.option.centerPosition){case"left":i=this.option.padding[0],e=this.size.h/2,o=Math.min(this.size.w-2*this.option.padding[0],this.size.h/2-this.option.padding[1]),c&&(this.option.startArg=-s/2,this.option.endArg=s/2);break;case"right":i=this.size.w-this.option.padding[0],e=this.size.h/2,o=Math.min(this.size.w-2*this.option.padding[0],this.size.h/2-this.option.padding[1]),c&&(this.option.startArg=s/2,this.option.endArg=3*s/2);break;case"top":i=this.size.w/2,e=this.option.padding[1],o=Math.min(this.size.w/2-this.option.padding[0],this.size.h-2*this.option.padding[1]),c&&(this.option.startArg=0,this.option.endArg=s);break;case"bottom":i=this.size.w/2,e=this.size.h-this.option.padding[1],o=Math.min(this.size.w/2-this.option.padding[0],this.size.h-2*this.option.padding[1]),c&&(this.option.startArg=s,this.option.endArg=2*s)}let x=o*this.option.tickWidthPercent;x<this.option.minTickWidth&&(x=this.option.minTickWidth),x>this.option.maxTickWidth&&(x=this.option.maxTickWidth);let d=o-x;switch(d=d>0?d:.1,this.option.centerPosition){case"left":n=i-.6*x,a=e-d-x/2,h=90,l=i-.6*x,r=e+d+x/2,p=90,this.option.minLabelTextBaseline="top",this.option.maxLabelTextBaseline="top",this.option.valueTextAlign="left";break;case"right":n=i,a=e-d-x/2,h=-90,l=i,r=e+d+x/2,p=-90,this.option.valueTextAlign="right",this.option.minLabelTextBaseline="bottom",this.option.maxLabelTextBaseline="bottom";break;case"top":n=i-d-x/2,a=e-x/6,l=i+d+x/2,r=e-x/6,this.option.minLabelTextBaseline="bottom",this.option.maxLabelTextBaseline="bottom",this.option.valueTextBaseline="top";break;case"bottom":n=i-d-x/2,a=e,l=i+d+x/2,r=e,this.option.minLabelTextBaseline="top",this.option.maxLabelTextBaseline="top",this.option.valueTextBaseline="bottom"}let u=x/this.option.tickRatio,m=u/d,g=m*this.option.BlankTickRatio,{startArg:T,endArg:b}=this.option,f=b-T;for([m,g]=this.correctArgAndGutterArg(m,g,f),this.ctx.beginPath();T<b;){let[t,s]=this.calcArgPoint(i,e,T,d,o);this.ctx.moveTo(...t),this.ctx.lineTo(...s),T=T+m+g,T>b&&(T=b)}this.ctx.lineWidth=u,this.ctx.lineCap=this.option.lineCap,this.ctx.strokeStyle=this.option.backgroundColor,this.ctx.stroke();let k=this.option.startArg;for(T=this.option.startArg,b=f*t/100+T;b>T;){let[t,s]=this.calcArgPoint(i,e,T,d,o);this.ctx.beginPath(),this.ctx.moveTo(...t),this.ctx.lineTo(...s),this.ctx.lineWidth=u,this.ctx.lineCap=this.option.lineCap,this.ctx.strokeStyle=this.calcColor((T-k)/f),this.ctx.stroke(),T=T+m+g,T>b&&(T=b)}if(this.option.showValue){let o=this.option.value,s=this.getFZ(d),n=this.option.valueTextAlign,a=this.option.valueTextBaseline,h=this.calcColor(t/100),[l,r]=this.option.valueOffset;l=i+l,r=e+r;let p=d-4;this.drawText(o,l,r,s,h,n,a,0,p)}if(this.option.showMinLabel){let t=this.option.min,i=this.getFZ(x),e=this.option.minLabelTextAlign,o=this.option.minLabelTextBaseline,s=this.option.minLabelColor,[l,r]=this.option.minLabelOffset;l=n+x/2+l,r=a+r,this.drawText(t,l,r,i,s,e,o,h)}if(this.option.showMaxLabel){let t=this.option.max,i=this.getFZ(x),e=this.option.maxLabelTextAlign,o=this.option.maxLabelTextBaseline,[s,n]=this.option.maxLabelOffset,a=this.option.maxLabelColor;s=l+x/2+s,n=r+n,this.drawText(t,s,n,i,a,e,o,p)}}}}]);